# 社区二手交易小程序需求说明

## 项目概述
- 面向同一小区住户的二手交易微信小程序
- 角色包含买家、卖家、管理员；物品发布免审核
- 采用微信云开发（云函数、云数据库、云存储）并接入微信支付

## 核心业务流程
- **物品发布**：卖家填写标题、描述、价格、物品状态、交易地点并上传图片，发布后立即上架
- **锁定认购**：买家点击“想要”锁定物品，锁定时长为全局配置；锁定期内其他买家不可下单
- **取消 / 释放**：买家主动取消或锁定超时后，物品即时回到“可售”状态；系统通过定时任务自动释放超时订单
- **成交与支付**：支持微信线上支付，支付成功后物品状态更新为“已售出”，后续线下交付并可扩展退款流程
- **通知订阅**：锁定、释放、售出等事件通过订阅消息推送给关注该物品的用户以及当前买家/卖家

## 系统功能模块
- **用户与权限**：注册登录、角色管理（含管理员运营工具）、小区身份校验（邀请码/物业名单/地理围栏）
- **商品管理**：上架、编辑、下架、图片存储、按分类和状态搜索筛选
- **交易管理**：锁定记录、支付订单、定时任务、退款/异常处理接口
- **消息与互动**：订阅消息模板管理、留言/客服消息记录、通知中心
- **后台运营**：数据统计、违规处理、支付对账、锁定异常处理

## 数据模型建议
- `users`：用户基础信息、角色、认证状态
- `items`：卖家ID、详情、图片列表、价格、当前状态
- `locks`：物品ID、买家ID、锁定时间范围、状态 (`active|cancelled|expired|completed`)
- `orders`：支付单号、金额、状态 (`pending|paid|refunded|completed`)
- `subscriptions`：用户-物品订阅关系及通知类型
- `messages`：留言内容、关联物品、通知状态

## 小程序页面规划
- 首页/分类列表 → 物品详情（订阅/留言/锁定）
- 发布与编辑页面（卖家入口）
- 我的页面：我的发布、锁定中、已购买、通知中心
- 管理员页面：统计面板、异常列表、对账工具

## 后续工作重点
1. 确认小区身份校验方案与锁定时长配置
2. 细化支付后退款与完成确认流程
3. 整理订阅消息模板并申请消息权限
4. 绘制页面原型与交互流程图
5. 设计云函数接口、触发器及数据库索引
